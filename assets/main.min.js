  $(document).ready(function () {

    //swap png for svg if svg not supported
    if (!Modernizr.svg) {
      $('img[src*="svg"]').attr('src', function () {
        return $(this).attr('src').replace('.svg', '.png');
      });
    }

    //adding class to last-child columns for <ie9
    var gridLast = $('.col-3:last-child, .col-4:last-child, .col-5:last-child, .col-6:last-child, .col-7:last-child, .col-8:last-child, .col-9:last-child');
    gridLast.addClass('last-col');

    //if not small screen nav move utility links to top
    //add container for links at top
    $('.masthead-wrap').prepend('<div id="utility-top"><div class="wrapper menu"></div></div>');
    //on page load move to top if no menu-link
    if ($('.menu-link').css('display') == 'none') {
      $('#utility-top .wrapper').append($('.utility-links'));
    }
    //on page resize move to top if no menu-link
    $(window).resize(function () {
      if ($('.menu-link').css('display') == 'none') {
        $('#utility-top .wrapper').append($('.utility-links'));
      } else {
        $('nav#menu').append($('.utility-links'));
      }
    });


    // Add placeholder text to search input
    $('input[name$="search_block_form"]').attr('placeholder', 'Search');

    // placeholder fallback
    $('input, textarea').placeholder();

    // toggle menus on small screens
    $('body').addClass('js');
    var $menu = $('#menu'),
      $menulink = $('.menu-link'),
      $menuTrigger = $('.has-subnav > a');

    $menulink.click(function (e) {
      e.preventDefault();
      $menulink.toggleClass('active');
      $menu.toggleClass('active');
    });

    $menuTrigger.click(function (e) {
      e.preventDefault();
      var $this = $(this);
      $this.toggleClass('active').next('ul').toggleClass('active');
    });


    // adds a class to any a-z phone# not starting with 826
    var phonecell = $('.phone-cell');
    phonecell.each(function () {
      if ($(this).text().substring(0, 3) !== '826') {
        $(this).addClass('no-prefix');
      }
    });

    // adding and icon to programs with options toggling visibility
    var plus = '<svg class="i-side-small"><use xlink:href="#icon-plus"></svg>';
    var minus = '<svg class="i-side-small"><use xlink:href="#icon-minus"></svg>';

    $('.mp-layout .item-list').prepend('<span>Program Options:</span>');
    $('.mp-layout .views-row').has('.item-list').prepend('<span class="i-option">' + plus + '</span>');
    $('.mp-layout .item-list').hide();
    $('.i-option').click(function () {
      $(this).parent().find('.item-list').toggle();
      $(this).toggleClass('close');
      if (!$(this).hasClass('close')) {
        $(this).find('svg').replaceWith(plus);
      } else {
        $(this).find('svg').replaceWith(minus);
      }
    });

    // showing & hiding fast facts
    $('.key-facts').append('<div class="more-facts"><p>' + plus + 'show more Cal Poly Humboldt facts below</p></div>');
    $('.students-from').append('<div class="close-facts">' + minus + 'hide facts</div>');
    $('.b-about-facts').hide();
    $('.more-facts, .close-facts').click(function () {
      $('.b-about-facts').toggle('slow');
      $('.more-facts').toggleClass('close');
      if (!$(this).hasClass('close')) {
        $('.more-facts p').replaceWith('<p>' + plus + 'show more Cal Poly Humboldt facts below</p>');
      } else {
        $('.more-facts p').replaceWith('<p>' + minus + 'hide facts</p>');
      }
    });

    //sticking programs nav
    $('.programs-menu').waypoint('sticky');
    var sections = $('.program-group');
    var navigation_links = $('.programs-menu nav a');
    sections.waypoint({
      handler: function (direction) {
        active_section = $(this);
        if (direction === 'up') active_section = active_section.prev();
        var active_link = $('.programs-menu nav a[href="#' + active_section.attr("id") + '"]');
        navigation_links.removeClass('selected');
        active_link.addClass('selected');
      }
    });
    //scrolling to anchors
    navigation_links.click(function (event) {
      $.scrollTo($(this).attr("href"), {
        duration: 400,
        offset: {
          'left': 0,
          'top': 3
        }
      });
    });

    // Expand/collapse site search
    new UISearch(document.getElementById('sb-search'));

    // include html5 video controls for mobile devices. video play button won't show without it
    if ((navigator.userAgent.match(/iPad|iPhone|Android|BlackBerry|Windows Phone|webOS/i)) && (navigator.userAgent.match(/iPad|iPhone|Android|BlackBerry|Windows Phone|webOS/i) != null)) {
      // alert('Mobile');
      $('video').prop("controls", true);
    }
    //Track clicks on homepage to livefromhsu instagram
    // $("a.live-feature--button").each(function () {

    //   var href = $(this).attr("href");
    //   var target = $(this).attr("target");
    //   var text = $(this).text();
    //   $(this).click(function (event) { // when someone clicks these links
    //     event.preventDefault(); // don't open the link yet
    //     ga('send', 'event', 'Live From HSU CTA', 'click', text); // create a custom event
    //     setTimeout(function () { // now wait 300 milliseconds...
    //       window.open(href, (!target ? "_self" : target)); // ...and open the link as usual
    //     }, 300);
    //   });
    // });

  });
